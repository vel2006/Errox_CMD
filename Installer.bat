@echo off
echo Testing if GitHub repo is reachable...
powershell -Command "try {Invoke-WebRequest -Uri 'https://vel2006.github.io/Errox_CMD/test_connection.html' -ErrorAction Stop} catch {exit 1} exit 0" >nul
if %errorlevel% neq 0 (
    echo GitHub not reachable, creating via base64...
    echo Creating GatherSystemInfo script...
    echo QGVjaG8gb2ZmCnNldCBnZXRfbWljcm9zb2Z0X2RlZmVuZGVyX3NldHRpbmdzPXBvd2Vyc2hlbGwgLUNvbW1hbmQgIkdldC1NcENvbXB1dGVyU3RhdHVzIgolZ2V0X21pY3Jvc29mdF9kZWZlbmRlcl9zZXR0aW5ncyU+Ii5kZWZlbmRlcl9zdGF0dXMudHh0IgplY2hvIEdldHRpbmc6IERlZmVuZGVyIHN0YXR1cyBhbmQgaW5mb3JtYXRpb24Kc2V0IGdldF9hcHBfbG9ja2VyX3NldHRpbmdzPXBvd2Vyc2hlbGwgLUNvbW1hbmQgIkdldC1BcHBMb2NrZXJQb2xpY3kgLUVmZmVjdGl2ZSB8IHNlbGVjdCAtRXhwYW5kUHJvcGVydHkgUnVsZUNvbGxlY3Rpb24iCiVnZXRfYXBwX2xvY2tlcl9zZXR0aW5ncyU+Ii5sb2NrZXJfcnVsZXMudHh0IgplY2hvIEdldHRpbmc6IEFwcCBMb2NrZXIgc2V0dGluZ3MKc2V0IGdldF9hcHBfbG9ja2VyX2NtZD1wb3dlcnNoZWxsIC1Db21tYW5kICJHZXQtQXBwTG9ja2VyUG9saWN5IC1Mb2NhbCB8IFRlc3QtQXBwTG9ja2VyUG9saWN5IC1wYXRoIEM6XFdpbmRvd3NcU3lzdGVtMzJcY21kLmV4ZSAtVXNlciBFdmVyeW9uZSIKJWdldF9hcHBfbG9ja2VyX2NtZCU+Ii5jbWRfYXZhbGliLnR4dCIKZWNobyBHZXR0aW5nOiBJZiBjbWQuZXhlIGlzIGF2YWxhYmxlCnNldCBnZXRfc3lzdGVtX2luZm89c3lzdGVtaW5mbwolZ2V0X3N5c3RlbV9pbmZvJT4iLnN5c3RlbV9pbmZvLnR4dCIKZWNobyBHZXR0aW5nOiBTeXN0ZW0gaW5mbwpzZXQgZ2V0X2hvdGZpeGVzPXdtaWMgcWZlCiVnZXRfaG90Zml4ZXMlPiIuaG90Zml4ZXMudHh0IgplY2hvIEdldHRpbmc6IEhvdGZpeGVzCnNldCBnZXRfc29mdHdhcmVfdmVyc2lvbnM9cG93ZXJzaGVsbCAtQ29tbWFuZCAiR2V0V21pT2JqZWN0IC1DbGFzcyBXaW4zMl9Qcm9kdWN0IHwgc2VsZWN0IE5hbWUsIFZlcnNpb24iCiVnZXRfc29mdHdhcmVfdmVyc2lvbnMlPiIuc29mdHdhcmVfdmVyc2lvbnMudHh0IgplY2hvIEdldHRpbmc6IFNvZnR3YXJlIHZlcnNpb25zCnNldCBnZXRfcm91dGU9cm91dGUgcHJpbnQKJWdldF9yb3V0ZSU+Ii5yb3V0ZS50eHQiCmVjaG8gR2V0dGluZzogUm91dGluZyB0YWJsZQpzZXQgZ2V0X2Nvbm5lY3Rpb25zPW5ldHN0YXQgLWFubwolZ2V0X2Nvbm5lY3Rpb25zJT4iLmNvbm5lY3Rpb25zLnR4dCIKZWNobyBHZXR0aW5nOiBDdXJyZW50IGNvbm5lY3Rpb25zOgpzZXQgZ2V0X2lwX2luZm89aXBjb25maWcgL2FsbAolZ2V0X2lwX2luZm8lPiIuaXBjb25maWcudHh0IgplY2hvIEdldHRpbmc6IElQIHRhYmxlCnNldCBnZXRfdXNlcnM9cXVlcnkgdXNlcgolZ2V0X3VzZXJzJT4iLmN1cnJlbnRfdXNlcnMudHh0IgplY2hvIEdldHRpbmc6IEN1cnJlbnQgbG9nZ2VkIGluIHVzZXJzIHZpYSBxdWVyeQpzZXQgZ2V0X2N1cnJlbnRfcGVybXM9d2hvYW1pIC9wcml2CiVnZXRfY3VycmVudF9wZXJtcyU+Ii5jdXJyZW50X3Blcm1zLnR4dCIKc2V0IGdldF9jdXJyZW50X3Blcm1zPXdob2FtaSAvZ3JvdXBzCiVnZXRfY3VycmVudF9wZXJtcyU+PiIuY3VycmVudF9wZXJtcy50eHQiCnNldCB1c2VyPSVVU0VSTkFNRSUKZWNobyBHZXR0aW5nOiBDdXJyZW50IHVzZXIgJyV1c2VyJScgcGVybXMKc2V0IGdldF9hbGxfdXNlcnM9bmV0IHVzZXIKJWdldF9hbGxfdXNlcnMlPiIuYWxsX3VzZXJzLnR4dCIKZWNobyBHZXR0aW5nOiBBbGwgdXNlcnMKc2V0IGdldF9hbGxfZ3JvdXBzPW5ldCBsb2NhbGdyb3VwCiVnZXRfYWxsX2dyb3VwcyU+Ii5hbGxfZ3JvdXBzLnR4dCIKZWNobyBHZXR0aW5nOiBBbGwgZ3JvdXBzCnNldCBnZXRfcGFzc3dvcmRfcG9saWN5PW5ldCBhY2NvdW50cwolZ2V0X3Bhc3N3b3JkX3BvbGljeSU+Ii5wYXNzd29yZF9wb2xpY3kudHh0IgplY2hvIEdldHRpbmc6IFBhc3N3b3JkIHBvbGljeSBhbmQgb3RoZXIgaW5mbwo=>temp.bin
    certutil -decode temp.bin GatherSystemInfo.bat >nul
    echo Creating BatchTerminal script...
    echo QGVjaG8gb2ZmCjpsb29wCnNldCBjZGlyPSVDRCUKc2V0IHVzcj0lVVNFUk5BTUUlCnNldCAvcCB1c3JfY21kPSIldXNyJUAlY2RpciU+ICIKJXVzcl9jbWQlCnNldCB1c3JfY21kPSIgIgpnb3RvIGxvb3AKZWNobyBTb21laG93IGV4aXRlZCB0aGUgbWFpbiBsb29wCnBhdXNlCg==>temp.bin
    certutil -decode temp.bin BatchTerminal.bat >nul
    echo Creating InstallPython script...
    echo QGVjaG8gb2ZmCmVjaG8gU2VlaW5nIGlmIHB5dGhvbiBpcyBpbnN0YWxsZWQKcHl0aG9uIC0tdmVyc2lvbiA+bnVsCmlmICVlcnJvcmxldmVsJSBuZXEgMCAoCiAgICBlY2hvIFB5dGhvbiBpcyBub3QgaW5zdGFsbGVkLCBpbnN0YWxsaW5nCiAgICBzZXQgUHl0aG9uVmVyc2lvbj0zLjEyLjQKICAgIHNldCBQeXRob25JbnN0YWxsZXI9aHR0cHM6Ly93d3cucHl0aG9uLm9yZy9mdHAvcHl0aG9uLyVQeXRob25WZXJzaW9uJS9weXRob24tJVB5dGhvblZlcnNpb24lLWFtZDY0LmV4ZQogICAgc2V0IEluc3RhbGxlclBhdGg9JVRFTVAlXHB5dGhvbi1pbnN0YWxsZXIuZXhlCiAgICBwb3dlcnNoZWxsIC1Db21tYW5kICJJbnZva2UtV2ViUmVxdWVzdCAtVXJpICclUHl0aG9uSW5zdGFsbGVyJScgLU91dEZpbGUgJyVJbnN0YWxsZXJQYXRoJSciCiAgICAlSW5zdGFsbGVyUGF0aCUgL3F1aWV0IEluc3RhbGxBbGxVc2Vycz0xIFByZXBlbmRQYXRoPTEKICAgIGVjaG8gcHl0aG9uIHNob3VsZCBiZSBpbnN0YWxsZWQgbm93CikgZWxzZSAoCiAgICBlY2hvIFB5dGhvbiBpcyBpbnN0YWxsZWQsIHZlcnNpb24gYmVsb3cKICAgIHB5dGhvbiAtLXZlcnNpb24KKQ==>temp.bin
    certutil -decode temp.bin InstallPython.bat >nul
    echo Creating Main script...
    echo QGVjaG8gb2ZmCnRpdGxlIEVycm94X0NNRAplY2hvICBfX19fXyAgICAgICAgICAgICAgICAgICAgICAgIF9fX18gX18gIF9fIF9fX18gIAplY2hvIF58IF9fX19efF8gX18gXyBfXyBfX19fXyAgX18gICAvIF9fX158ICBcLyAgXnwgIF8gXCAKZWNobyBefCAgX158IF58ICdfX158ICdfXy8gXyBcIFwvIC8gIF58IF58ICAgXnwgXnxcL158IF58IF58IF58IF58CmVjaG8gXnwgXnxfX19efCBefCAgXnwgXnwgXnwgKF8pIF4+ICBePCAgIF58IF58X19fXnwgXnwgIF58IF58IF58X158IF58CmVjaG8gXnxfX19fX158X158ICBefF9efCAgXF9fXy9fL1xfXF9fX1xfX19fXnxfXnwgIF58X158X19fXy8gCmVjaG8gICAgICAgICAgICAgICAgICAgICAgICAgXnxfX19fX158CmVjaG8uCmVjaG8gICAgICAgICAgICAgICAgICAgICAgQ3JlYXRlZCBCeTogVGhhdDFFdGhpY2FsSGFja2VyCmVjaG8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmVyc2lvbjogMi4yCmVjaG8uCjo6IFN0YXJ0aW5nIGJhc2ljIGluZm8gZ3JhYmJpbmcgZm9yIGEgbGF5IG9mIHRoZSBsYW5kCmVjaG8gU3RhcnRpbmcgYSBnYXRoZXIgb2YgaW5mb3JtYXRpb24gZm9yIGEgbGF5IG9mIHRoZSBsYW5kCmNhbGwgR2F0aGVyU3lzdGVtSW5mby5iYXQKZWNobyBSdW5uaW5nIEluc3RhbGxQeXRob24uYmF0IHNjcmlwdApjYWxsIEluc3RhbGxQeXRob24uYmF0CmVjaG8gU3RhcnRpbmcgYSBiYXRjaCBzaGVsbCB0byBieXBhc3MgYSBibG9jayBvZiBjbWQuZXhlCmNhbGwgQmF0Y2hUZXJtaW5hbC5iYXQK>temp.bin
    certutil -decode temp.bin main.bat >nul
    del temp.bin
) else (
    echo GitHub is reachable, creating via download...
    echo Getting GatherSystemInfo script...
    powershell -Command "Invoke-WebRequest -Uri 'https://vel2006.github.io/Errox_CMD/GatherSystemInfo.bat' -OutFile 'GatherSystemInfo.bat'
    echo Getting BatchTerminal script...
    powershell -Command "Invoke-WebRequest -Uri 'https://vel2006.github.io/Errox_CMD/BatchTerminal.bat' -OutFile 'BatchTerminal.bat'
    echo Getting InstallPython script...
    powershell -Command "Invoke-WebRequest -Uri 'https://vel2006.github.io/Errox_CMD/InstallPython.bat' -OutFile 'InstallPython.bat'
    echo Getting Main script...
    powershell -Command "Invoke-WebRequest -Uri 'https://vel2006.github.io/Errox_CMD/main.bat' -OutFile 'main.bat'
)
echo Install Script ended, run main.bat for Errox_CMD
pause
